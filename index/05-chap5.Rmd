# New York City Taxi Fare & Limousine Commission {#chapter5}

## Should there be a flat rate between Manhattan and John F. Kennedy International Airport?

### People in Manhattan benefit from the $52 flat rate.
Why is there a flat rate to and from JFK airport and any location in Manhattan? Why is the flat rate \$52? Does TLC make profit from the \$52 flat rate? Does \$52 reduce the cogestion on the road to JFK airport and make taking a train a more preferable choice?

If there is no flat rate between JFK and Manhattan, 

```{r}
jfk_trip <- yellow_2016.08_cleaned %>%
  filter(RatecodeID == 2) %>%
  filter(payment_type != 3) %>%
  filter(trip_distance > 0) %>%
  filter(fare_amount > 0) %>%
  filter(PULocationID != DOLocationID) %>%
  mutate(est_fare = 2.5 + 0.5 * trip_distance * 5 + extra + 
           improvement_surcharge + mta_tax + tolls_amount,
         est_diff = est_fare - fare_amount)

to_jfk <- jfk_trip %>%
  filter(DOLocationID == 132)
```


```{r}
to_jkf_zone <- to_jfk %>%
  group_by(PULocationID) %>%
  summarise(num_trips = n(),
            avg_dis = mean(trip_distance),
            avg_fare = mean(est_fare)) %>%
  rename(LocationID = PULocationID) %>%
  left_join(taxi_zone_lookup , by = "LocationID")

#to_jkf_fare <- merge(taxi_zones, to_jkf_zone, by.x = "LocationID", by.y = "PULocationID")


```


```{r}
to_jkf_zone_above <- to_jkf_zone %>%
  filter(Borough == "Manhattan") %>%
  #filter(avg_fare >= 52) %>%
  arrange(desc(avg_fare))

kable(to_jkf_zone_above[1:44,], caption = "Pick-up Zones with avergae fare to JKF Airport")
```

Imagine it's your first time travelling to New York City, and you decided to live in a hotel in Manhattan Since you do not know much about the city, the \$52 flat rate is nice for you, and it incentivizes you to take taxi to the JFK Airport. If there is no flat rate, there is uncertainty in how much someone needs to pay to take a taxi to JFK, and tourists might instead choose to take the train, even though taking a train would cost them more time and inconvenience. 

Additionally, people who are native to Manhattan would have paid more than $52 to take a taxi to go to the JFK Airport. The higher the taxi fare is, the less the demand for taxi will be. Therefore, having a flat rate,helps taxi drivers to get more trips from Manhattan to JFK Airport.


## However, are taxi drivers happy with the flat rate? 

What the expected fare from JKF Airport to Manhattan?

```{r, eval=FALSE}
from_jfk <- jfk_trip %>%
  filter(PULocationID == 132)

from_jkf_zone <- from_jfk %>%
  group_by(DOLocationID) %>%
  summarise(num_trips = n(),
            avg_dis = mean(trip_distance),
            avg_fare = mean(est_fare)) %>%
  rename(LocationID = DOLocationID) %>%
  left_join(taxi_zone_lookup , by = "LocationID")

from_jkf_fare <- merge(taxi_zones, from_jkf_zone, by.x = "LocationID", by.y = "LocationID")

#cols <- brewer.pal(n = 4, name = "Greys")
lcols <- cut(from_jkf_fare$avg_fare,
             breaks = quantile(from_jkf_fare$avg_fare, na.rm = TRUE),
             labels = cols)
plot(from_jkf_fare, col = as.character(lcols))
```

```{r from_jkf_zone_above, eval=FALSE}
from_jkf_zone_above <- from_jkf_zone %>%
  filter(Borough == "Manhattan") %>%
  #filter(avg_fare >= 52) %>%
  arrange(desc(avg_fare))

kable(to_jkf_zone_above[1:67,], caption = "Drop-off Zones with average fare amount from JFK Airport")
```


how much time it would take for a cb driver to do a round trip 

